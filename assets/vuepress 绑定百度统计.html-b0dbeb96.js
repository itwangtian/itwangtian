import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as c,c as i,a as n,b as s,e as t,f as e}from"./app-5e85373d.js";const u={},l=n("blockquote",null,[n("p",null,"本篇教程适用于 vuepress2 版本")],-1),r=n("br",null,null,-1),d={href:"https://tongji.baidu.com/",target:"_blank",rel:"noopener noreferrer"},k=n("br",null,null,-1),v=n("br",null,null,-1),m={href:"https://tongji.baidu.com/main/setting/10000320023/home/site/index",target:"_blank",rel:"noopener noreferrer"},b=n("br",null,null,-1),g=n("br",null,null,-1),h=n("img",{src:"https://raw.githubusercontent.com/itwangtian/itwangtian/images/a51c6a38c454d04ed9d2cb616572acec.png",alt:"image.png",loading:"lazy"},null,-1),f=n("br",null,null,-1),_=n("br",null,null,-1),x=n("img",{src:"https://raw.githubusercontent.com/itwangtian/itwangtian/images/168c31ee2d426f9cfb06ae9590283de4.png",alt:"image.png",loading:"lazy"},null,-1),w=e(`<p>获取代码 ，插入博客中，用于站点与百度统计互联<br><img src="https://raw.githubusercontent.com/itwangtian/itwangtian/images/7c283bcf4fcb812251df55543c269fd3.png" alt="image.png" loading="lazy"><br> 配置流程如下：<br><img src="https://raw.githubusercontent.com/itwangtian/itwangtian/images/c2f1809507fc3cdfd475784855639555.png" alt="image.png" loading="lazy"></p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>注意！<br> 在配置统计代码时，查看了多个教程，都是以代码块的方式配置，但是本地运行创建标签出错，导致统计代码运行失败</p></div><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>module<span class="token punctuation">.</span>exports = <span class="token punctuation">{</span>
    head: <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>
        <span class="token string">&#39;script&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> \`
        <span class="token keyword">var</span> _hmt = _hmt <span class="token punctuation">|</span><span class="token punctuation">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> hm = document<span class="token punctuation">.</span>createElement<span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          hm<span class="token punctuation">.</span>src = <span class="token string">&quot;https://hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxx&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> s = document<span class="token punctuation">.</span>getElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">;</span>
          s<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span>insertBefore<span class="token punctuation">(</span>hm<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        &lt;<span class="token operator">/</span>script&gt;
        \`
      <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>经过尝试后，直接使用 vuepress 中的 head 配置，来生成一个 script 标签，插入 header 中即可，不存在异步创建标签问题。</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineUserConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  head<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;script&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&quot;text/javascript&quot;</span><span class="token punctuation">,</span>
        src<span class="token operator">:</span> <span class="token string">&quot;https://hm.baidu.com/hm.js?ff5e95667789a353e9be4e467e13ff3a&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>head 配置参数<br> 第一个参数：标签名称 -script 标签<br> 第二个参数：标签配置项- type 类型为&#39;text/javascript&#39;，src 为百度统计代码访问地址<br> 第三个三次：代码块 、可忽略</p><p>检测效果<br> 注意，通过 js 方式链接百度统计，代码检查无法检查到<br> 官方说法：</p>`,7),q={href:"https://tongji.baidu.com/web/help/article?id=317&type=0",target:"_blank",rel:"noopener noreferrer"},y=e('<p>需要通过百度统计助手检测，安装地址 →<br> 安装插件后检测，此时提示站点已安装统计助手，咱们后续登录百度统计后台，就能查看博客数据啦<br><img src="https://raw.githubusercontent.com/itwangtian/itwangtian/images/93197ec4bf6c1abfae6ac79cec69376e.png" alt="image.png" loading="lazy"><br> 等待</p><h3 id="_1-4-等待" tabindex="-1"><a class="header-anchor" href="#_1-4-等待" aria-hidden="true">#</a> 1.4 等待</h3><p>如果百度统计插件助手提示安装成功，一般需等待 20 分钟左右，可登录后台查看数据<br> 注意！以 js 方式介入百度统计，代码安装检测无法识别<br><img src="https://raw.githubusercontent.com/itwangtian/itwangtian/images/5f7a0ec82e99b96c20dc8b77859e88c4.png" alt="image.png" loading="lazy">没关系，百度插件助手提示接入成功就行，<br> 如下，打开统计后台，咱们就能看到本地访问的实时记录<br><img src="https://raw.githubusercontent.com/itwangtian/itwangtian/images/045a9375434502992ab0465e12ca93fe.png" alt="image.png" loading="lazy"><br> 完成以上步骤，算是接入百度统计 50%了<br> 注意！vuepress 是 以 vue 框架开的一个单应用程序，在切换路由时不会触发页面渲染，导致咱们访问文章页时因无法触发百度统计，当如何解决此问题呢？<br> 通过 vue 的路由守卫，在路由切换时，手动上报百度统计。</p><p>在查阅文档时，我发现不少博主是用 vuepress1 建站，创建 enhanceapp.js 来设置路由守卫，此方式在 vuepress2.0 无效<br> 官网解释</p>',4),j={id:"vuepress-enhanceapp-js",tabindex:"-1"},E=n("a",{class:"header-anchor",href:"#vuepress-enhanceapp-js","aria-hidden":"true"},"#",-1),z={href:"https://v2.vuepress.vuejs.org/zh/guide/migration.html#vuepress-enhanceapp-js",target:"_blank",rel:"noopener noreferrer"},A=n("br",null,null,-1),B={href:"https://v2.vuepress.vuejs.org/zh/advanced/cookbook/usage-of-client-config.html",target:"_blank",rel:"noopener noreferrer"},P={href:"https://vuepress.vuejs.org/zh/guide/basic-config.html#%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E9%85%8D%E7%BD%AE",target:"_blank",rel:"noopener noreferrer"},V=e(`<blockquote><p>由于 VuePress 是一个标准的 Vue 应用，你可以通过创建一个 .vuepress/enhanceApp.js 文件来做一些应用级别的配置，当该文件存在的时候，会被导入到应用内部。enhanceApp.js 应该 export default 一个钩子函数，并接受一个包含了一些应用级别属性的对象作为参数。你可以使用这个钩子来安装一些附加的 Vue 插件、注册全局组件，或者增加额外的路由钩子等：</p></blockquote><p>代码如下：</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>export default <span class="token punctuation">(</span><span class="token punctuation">{</span> router <span class="token punctuation">}</span><span class="token punctuation">)</span> =&gt; <span class="token punctuation">{</span>
    router<span class="token punctuation">.</span>beforeEach<span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next<span class="token punctuation">)</span> =&gt; <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>typeof _hmt <span class="token operator">!</span>== <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          _hmt<span class="token punctuation">.</span>push<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;_trackPageview&quot;</span><span class="token punctuation">,</span> to<span class="token punctuation">.</span>fullPath<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      next<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="客户端配置路由守卫" tabindex="-1"><a class="header-anchor" href="#客户端配置路由守卫" aria-hidden="true">#</a> 客户端配置路由守卫</h2><p>vuepres2.0 版本，需要额外客户端配置，创建文件<code>.vuepress/client.js</code><br> 在客户端配置中添加路由守卫，代码如下：</p><div class="language-tsx line-numbers-mode" data-ext="tsx"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineClientConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vuepress/client&quot;</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;路由守卫了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">enhance</span><span class="token punctuation">(</span><span class="token punctuation">{</span> router <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;切换路由&quot;</span><span class="token punctuation">,</span> to<span class="token punctuation">.</span>fullPath<span class="token punctuation">,</span> from<span class="token punctuation">.</span>fullPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//触发百度的pv统计</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> _hmt <span class="token operator">!=</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          _hmt<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;_trackPageview&quot;</span><span class="token punctuation">,</span> to<span class="token punctuation">.</span>fullPath<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;上报百度统计&quot;</span><span class="token punctuation">,</span> to<span class="token punctuation">.</span>fullPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// continue</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>路由守卫方法接收三个参数：</p><ul><li>to: Route: 即将要进入的目标 路由对象</li><li>from: Route: 当前导航正要离开的路由</li><li>next: Function: 一定要调用该方法来 resolve 这个钩子</li></ul><p><strong>提示</strong><br> 切换路由时会触发统计上报。以下行为时会上报统计:</p><ul><li>首次访问</li><li>刷新页面</li><li>切换到当前文章的其它章节<br> 切换锚点，URL 会变化，所以会触发路由变化事件。<br> 所以，当用户完整得浏览完一篇博客时，可能会触发多次上报。</li></ul><p>总结</p><p>接入百度统计，本质是在访问站点时触发百度统计 api。</p>`,12);function C(N,L){const a=o("ExternalLinkIcon");return c(),i("div",null,[l,n("p",null,[s("注册百度统计"),r,n("a",d,[s("https://tongji.baidu.com/"),t(a)]),k,s(" 注册成功后，打开网站列表"),v,n("a",m,[s("https://tongji.baidu.com/main/setting/10000320023/home/site/index"),t(a)]),b,s(" 如下，新增网站配置"),g,h,f,s(" 新增站点"),_,x]),w,n("ul",null,[n("li",null,[s(".如果通过 js 文件调用的方式安装统计代码，由于无法直接在网站页面中找到统计代码，会提示“未检测到代码”，建议您使用 "),n("a",q,[s("百度统计助手"),t(a)]),s(" 进行检测；")])]),y,n("blockquote",null,[n("h4",j,[E,s(),n("a",z,[s("#"),t(a)]),s(".vuepress/enhanceApp.js")]),n("p",null,[s("重命名为 .vuepress/client.{js,ts} ，使用方法也有改动。"),A,s(" 参考 "),n("a",B,[s("深入 > Cookbook > 客户端配置的使用方法"),t(a)]),s(" 。")])]),n("p",null,[s("亲测踩坑，勿用！VuePress 文档的基本配置中，介绍了一个"),n("a",P,[s("应用级别的配置"),t(a)]),s("：")]),V])}const I=p(u,[["render",C],["__file","vuepress 绑定百度统计.html.vue"]]);export{I as default};
